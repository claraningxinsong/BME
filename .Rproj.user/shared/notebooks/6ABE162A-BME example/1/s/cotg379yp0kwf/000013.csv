"0","# Define hazard ratios "
"0","HRs <- cbind("
"0","  hrS = c(1, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7),"
"0","  hrSc = c(1, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2)"
"0","  )"
"0",""
"0","# Initialize results"
"0","results <- matrix(NA, nrow = nrow(HRs), ncol = 5)"
"0","colnames(results) <- c(""Power f"", "
"0","                       ""Power S"", "
"0","                       ""Overall Power"", "
"0","                       ""Probability of Expansion"", "
"0","                       ""Average Sample Size"")"
"0","alpha1 = 0.0125"
"0","alpha2 = 0.0125"
"0",""
"0","# Loop over each scenario"
"0","for (i in 1:nrow(HRs)) {"
"0","  # Run simulation"
"0","  res <- getOC_BME("
"0","    seed = 2025,"
"0","    nsim = 500,"
"0","    nF = 600,"
"0","    nS_additional = 100,"
"0","    prop_S = 0.5,"
"0","    duration = 20,"
"0","    duration_additional = 3,"
"0","    targetEvents.Sc = 105,"
"0","    targetEvents = c(210, 280, 420),"
"0","    HR.Sc.threshold = 0.9,"
"0","    hazard_S  = log(2)/c(9, 9/HRs[i, ""hrS""]), #currently assume med is same for BM+ and BM- in control"
"0","    hazard_Sc = log(2)/c(9, 9/HRs[i, ""hrSc""]),"
"0","    dropout_S = c(0, 0),"
"0","    dropout_Sc = c(0, 0),"
"0","    w = 1,"
"0","    ratio = 1,"
"0","    alpha1 = 0.0125,"
"0","    alpha2 = 0.0125"
"0","  )"
"0",""
"0","  # Extract statistics"
"0","  p_Fs <- sapply(res, function(x) x$reject$F_reject)"
"0","  p_Ss <- sapply(res, function(x) x$reject$S_reject)"
"0","  expansion <- sapply(res, function(x) x$expand)"
"0",""
"0","  # Store results"
"0","  results[i, ] <- c("
"0","    mean(p_Fs),"
"0","    mean(p_Ss),"
"0","    mean(p_Fs | p_Ss),"
"0","    mean(expansion),"
"0","    600 + 100 * mean(expansion)"
"0","  )"
"0","}"
