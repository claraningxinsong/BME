"0","alpha1 <- 0.0125"
"0","alpha2 <- 0.0125"
"0",""
"0","HRs <- cbind("
"0","  hrS  = c(1, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7),"
"0","  hrSc = c(1, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2)"
"0",")"
"0",""
"0","delta_orr_S  <- c(0, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2)"
"0","delta_orr_Sc <- c(0, 0.2, 0.15, 0.10, 0.05, 0, -0.05)"
"0",""
"0","simulate_scenario <- function(i, HRs, delta_orr_S, delta_orr_Sc) {"
"0","  "
"0","  # currently assume med is same for BM+ and BM- in control: medS_con = medSc_con = 9"
"0","  hazard_S  <- log(2) / c(9, 9 / HRs[i, ""hrS""])"
"0","  hazard_Sc <- log(2) / c(9, 9 / HRs[i, ""hrSc""])"
"0","  "
"0","  orr_S <- c(0.2, 0.2 + delta_orr_S[i])"
"0","  orr_Sc <- c(0.2, 0.2 + delta_orr_Sc[i])"
"0",""
"0","  res <- getOC_data(seed = 2025+i, nsim = 10,"
"0","                    nF = 700, prop_S = 0.5,"
"0","                    duration = 23, hazard_S = hazard_S, hazard_Sc = hazard_Sc,"
"0","                    dropout_S = c(0, 0), dropout_Sc = c(0, 0),"
"0","                    w = 1, ratio = 1,"
"0","                    orr_S = orr_S, orr_Sc = orr_Sc,"
"0","                    rho_S = 0.7, rho_Sc = 0.7,"
"0","                    enroll_month = 17)"
"0","  "
"0","  enrolled_by_month <- mean(res)"
"0","  "
"0","  return(enrolled_by_month)"
"0",""
"0","}"
"0",""
"0",""
"0","n_cores <- max(1L, detectCores() - 1L)"
"0","cl <- makeCluster(n_cores)"
"0",""
"0","clusterExport(cl, c(""HRs"", ""delta_orr_S"", ""delta_orr_Sc"","
"0","                    ""simulate_scenario"","
"0","                    ""getOC_data"","
"0","                    ""simu_enrich_trial"", ""cut_by_event"","
"0","                    ""logrank.one.sided"", ""log""))"
"0",""
"0","results_list <- lapply(1:nrow(HRs), function(i) simulate_scenario(i, HRs, delta_orr_S, delta_orr_Sc))"
"0",""
"0",""
"0","stopCluster(cl)"
"0",""
"0","results_df <- as.data.frame(cbind(HRs, "
"0","                                  do.call(rbind, results_list)))"
"0",""
"0","print(results_df)"
