"0","alpha1 <- 0.0125"
"0","alpha2 <- 0.0125"
"0",""
"0","HRs <- cbind("
"0","  hrS  = c(1, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7),"
"0","  hrSc = c(1, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2)"
"0",")"
"0",""
"0","delta_orr_S  <- c(0, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2)"
"0","delta_orr_Sc <- c(0, 0.2, 0.15, 0.10, 0.05, 0, -0.05)"
"0",""
"0","simulate_scenario <- function(i, HRs, delta_orr_S, delta_orr_Sc) {"
"0",""
"0","  # currently assume med is same for BM+ and BM- in control: medS_con = medSc_con = 9"
"0","  hazard_S  <- log(2) / c(9, 9 / HRs[i, ""hrS""])"
"0","  hazard_Sc <- log(2) / c(9, 9 / HRs[i, ""hrSc""])"
"0","  "
"0","  orr_S <- c(0.2, 0.2 + delta_orr_S[i])"
"0","  orr_Sc <- c(0.2, 0.2 + delta_orr_Sc[i])"
"0","  "
"0","  res <- getOC_BME_bydate("
"0","  nsim = 500,"
"0","  nF = 700, nS_additional = 150,"
"0","  prop_S = 0.5,"
"0","  duration = 23,"
"0","  duration_additional = 5,"
"0","  cutTime = 20, "
"0","  targetEvents = c(245, 350, 490),"
"0","  HR.Sc.threshold = 0.9,"
"0","  hazard_S  = hazard_S,  hazard_Sc = hazard_Sc,"
"0","  dropout_S = c(0, 0), dropout_Sc = c(0, 0),  w = 1, ratio = 1,"
"0","  orr_S = orr_S,"
"0","  orr_Sc = orr_Sc,"
"0","  rho_S = 0.7, rho_Sc = 0.7,"
"0","  alpha1 = alpha1, alpha2 = alpha2,"
"0","  selection = ""survival"","
"0","  orr_thres = 0.1"
"0",")"
"0","  return(c("
"0","    Power_F = mean(res$F.reject),"
"0","    Power_S = mean(res$S.reject),"
"0","    Overall_Power = mean(res$F.reject | res$S.reject),"
"0","    Prob_Expand = mean(res$expand),"
"0","    Avg_Sample_Size = 700 + 150 * mean(res$expand),"
"0","    Timing_S = mean(res$timing.S),"
"0","    Timing_F = mean(res$timing.F)"
"0","  ))"
"0",""
"0","}"
"0",""
"0",""
"0","n_cores <- max(1L, detectCores() - 1L)"
"0","cl <- makeCluster(n_cores)"
"0",""
"0","# Set up independent RNG streams"
"0","clusterSetRNGStream(cl, iseed = 2025)"
"0",""
"0","clusterExport(cl, c(""HRs"", ""delta_orr_S"", ""delta_orr_Sc"","
"0","                    ""simulate_scenario"",  "
"0","                    ""getZstats_IA_bydate"", ""getZstats_FA"","
"0","                    ""getZtests_BME"", ""getOC_BME_bydate"","
"0","                    ""simu_enrich_trial"", ""cut_by_event"","
"0","                    ""logrank.one.sided"", ""log""))"
"0",""
"0","results_list <- lapply(1:nrow(HRs), function(i) {"
"0","  simulate_scenario(i, HRs, delta_orr_S, delta_orr_Sc)"
"0","})"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 46 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 45 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 44 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 43 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 42 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 41 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 40 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 39 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 38 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 37 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 36 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 35 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 34 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 33 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 32 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 31 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 30 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 29 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 28 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 27 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 26 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 25 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 24 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 23 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 22 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 21 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 20 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 19 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 18 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 17 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 16 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 15 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 14 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 13 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 12 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 11 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 10 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 9 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 8 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 7 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 6 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 5 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 4 (<-DSI-JGPD6F3:11276)
"
"2","Warning in for (i in seq_len(differences)) r <- r[i1] - r[-length(r):-(length(r) -  :"
"2","
 "
"2"," closing unused connection 3 (<-DSI-JGPD6F3:11276)
"
"0","stopCluster(cl)"
"0",""
"0","results_df <- as.data.frame(cbind(HRs,"
"0","                                  do.call(rbind, results_list)))"
"0",""
"0",""
"0","print(round(results_df, 4))"
